cmake_minimum_required(VERSION 3.10)

# Proje AdÄ± ve Versiyonu
project(AthenaPilot VERSION 0.1.0 LANGUAGES CXX)

# C++ StandardÄ±: C++17 (Modern Ã¶zellikler iÃ§in ideal)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# --------------------------------------------------------------------------
# KONFÄ°GÃœRASYON SEÃ‡ENEKLERÄ°
# --------------------------------------------------------------------------
# Bu "Switch" sayesinde tek satÄ±r deÄŸiÅŸiklikle kodu PC veya STM32 iÃ§in derleyeceÄŸiz.
option(BUILD_SITL "Build for SITL (PC Simulation)" ON)

# Derleme UyarÄ±larÄ± (Kod kalitesi iÃ§in sÄ±kÄ± tutuyoruz)
if(MSVC)
    add_compile_options(/W4) # Windows Visual Studio iÃ§in
else()
    add_compile_options(-Wall -Wextra) # GCC/Clang iÃ§in
endif()

# --------------------------------------------------------------------------
# KAYNAK DOSYALARIN TOPLANMASI
# --------------------------------------------------------------------------
# src klasÃ¶rÃ¼ altÄ±ndaki tÃ¼m .cpp dosyalarÄ±nÄ± bulur
file(GLOB_RECURSE SOURCES "src/*.cpp")

# Header dosyalarÄ±mÄ±zÄ±n olduÄŸu klasÃ¶rÃ¼ tanÄ±tÄ±yoruz
include_directories(include)

# Ä°leride MAVLink kÃ¼tÃ¼phanesini buraya koyacaÄŸÄ±z
include_directories(src/lib) 
include_directories(src/lib/mavlink)

# --------------------------------------------------------------------------
# PLATFORM AYARLARI (SITL vs HARDWARE)
# --------------------------------------------------------------------------
if(BUILD_SITL)
    message(STATUS "ğŸŸ¢ Build Modu: SITL (PC SimÃ¼lasyonu)")
    # Derleme UyarÄ±larÄ±
if(MSVC)
    add_compile_options(/W4)
else()
    # -Wall -Wextra aÃ§Ä±yoruz ama MAVLink'in packed-member uyarÄ±sÄ±nÄ± susturuyoruz
    add_compile_options(-Wall -Wextra -Wno-address-of-packed-member)
endif()
    
    # PC UygulamasÄ±nÄ± oluÅŸtur (Executable)
    add_executable(AthenaPilot ${SOURCES})

    # Windows kullanÄ±yorsan Socket kÃ¼tÃ¼phanesini baÄŸla (UDP iÃ§in gerekli)
    if(WIN32)
        target_link_libraries(AthenaPilot ws2_32)
    endif()

else()
    message(STATUS "ğŸŸ  Build Modu: STM32 Hardware (HenÃ¼z aktif deÄŸil)")
    # Ä°leride buraya arm-none-eabi-gcc ayarlarÄ± ve linker script gelecek.
endif()